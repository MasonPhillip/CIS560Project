DECLARE @RolesStaging TABLE
(
   RoleId INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
   PersonId INT NOT NULL,
   MovieId INT NOT NULL,
   IsDirector BIT NOT NULL,
   IsActor BIT NOT NULL,
   AmountPaid INT NOT NULL
);

/***************************** Modify values here *****************************/

INSERT @RolesStaging(PersonId, MovieId, IsDirector, IsActor, AmountPaid)
VALUES
 (1, 1,1,0,131431984),
 (2, 1,0,1,250000),
 (3, 1,0,1,6000000),
 (4, 1,0,1,250000),
 (1, 2,1,0,139089678),
 (2, 2,0,1,1000000),
 (3, 2,0,1,7000000),
 (5, 2,0,1,13000000),
 (1, 3,1,0,162706112),
 (2, 3,0,1,1000000),
 (3, 3,0,1,6000000),
 (6, 4,1,0,84630284),
 (7, 4,0,1,28210094),
 (8, 4,0,1,16926056),
 (9, 4,0,1,5642018),
 (6, 5,1,0,231183186.45),
 (7, 5,0,1,77061062.15),
 (10, 5,0,1,46236637.29),
 (11, 5,0,1,30824424.86),
 (6, 6,1,0,229555080),
 (7, 6,0,1,76518360),
 (12, 6,0,1,45911016),
 (13, 6,0,1,30607344),
 (14, 7,1,0,225238403),
 (15, 7,0,1,30031787),
 (16, 7,0,1,45047680),
 (17, 7,0,1,37539733),
 (14, 8,1,0,145105853),
 (18, 8,0,1,48368617),
 (17, 8,0,1,29021170),
 (15, 8,0,1,24184308),
 (14, 9,1,0,187299170),
 (18, 9,0,1,62433056),
 (17, 9,0,1,37459834),
 (15, 9,0,1,31216528),
 (14, 10,1,0,185459477),
 (19, 10,0,1,21556451),
 (20, 10,0,1,37091895),
 (21, 10,0,1,30909912),
 (14, 11,1,0,124669354),
 (19, 11,0,1,41556451),
 (20, 11,0,1,24933870),
 (21, 11,0,1,20778225),
 (14, 12,1,0,117661853),
 (19, 12,0,1,39220617),
 (20, 12,0,1,23532370),
 (21, 12,0,1,19610308),
 (22, 13,1,0,451195866),
 (23, 13,0,1,150398622),
 (24, 13,0,1,90239173),
 (25, 13,0,1,75199311),
 (26, 14,1,0,293188363),
 (23, 14,0,1,97729454),
 (24, 14,0,1,58637672),
 (25, 14,0,1,48864727),
 (22, 15,1,0,238833737),
 (23, 15,0,1,79611245),
 (24, 15,0,1,47766747),
 (25, 15,0,1,39805622),
 (27, 16,1,0,9607938),
 (28, 16,0,1,3202646),
 (29, 16,0,1,1921587),
 (30, 16,0,1,1601323),
 (31, 17,1,0,7545950),
 (32, 17,0,1,2515316),
 (33, 17,0,1,1509190),
 (34, 17,0,1,1257658),
 (35, 18,1,0,1326936),
 (36, 18,0,1,442312),
 (37, 18,0,1,265387),
 (38, 18,0,1,221156),
 (39, 19,1,1,654694),
 (40, 19,0,1,98204),
 (41, 19,0,1,81836),
 (42, 20,1,0,58008433),
 (43, 20,0,1,19336144),
 (44, 20,0,1,11601686),
 (45, 20,0,1,9668072),
 (46, 21,1,0,47808792),
 (47, 21,0,1,18326703),
 (48, 21,0,1,9561758),
 (49, 21,0,1,7968132),
 (50, 22,1,0,1508658),
 (51, 22,0,1,5028860),
 (52, 22,0,1,3017310),
 (53, 22,0,1,2514430),
 (6, 23,1,0,169363772),
 (54, 23,0,1,56454590),
 (55, 23,0,1,33872754),
 (56, 23,0,1,28227295),
 (57, 24,1,0,62859009),
 (16, 24,0,1,20953003),
 (58, 24,0,1,12571801),
 (59, 24,0,1,10476501),
 (57, 25,1,0,227102556),
 (60, 25,0,1,75700852),
 (61, 25,0,1,45420511),
 (62, 25,0,1,37850426),
 (57, 26,1,0,127158851),
 (62, 26,0,1,42386283),
 (61, 26,0,1,25431770),
 (62, 26,0,1,21193141),
 (63, 27,1,0,82492902),
 (60, 27,0,1,27497634),
 (64, 27,0,1,16498580),
 (65, 27,0,1,13748817),
 (66, 28,1,0,8647753),
 (67, 28,0,1,2882584),
 (68, 28,0,1,1729550),
 (69, 28,0,1,1441292),
 (70, 29,1,0,7553083),
 (71, 29,0,1,2517694),
 (72, 29,0,1,1510616),
 (73, 29,0,1,1258847),
 (74, 30,1,0,151302260),
 (75, 30,0,1,50434086),
 (76, 30,0,1,30260452),
 (77, 30,0,1,25217043),
 (78, 31,1,0,95894948),
 (79, 31,0,1,31964982),
 (80, 31,0,1,19178989),
 (81, 31,0,1,15982491),
 (82, 32,1,0,14091975),
 (83, 32,0,1,4697325),
 (84, 32,0,1,2818395),
 (85, 32,0,1,2348662),
 (86, 33,1,0,99736),
 (87, 33,0,1,33245),
 (88, 33,0,1,19947),
 (89, 33,0,1,16622),
 (57, 34,1,0,104909880),
 (75, 34,0,1,34969960),
 (90, 34,0,1,20981976),
 (91, 34,0,1,17484980),
 (6, 35,1,0,144217583),
 (92, 35,0,1,48072527),
 (93, 35,0,1,28843516),
 (94, 35,0,1,24036263),
 (74, 36,1,0,89426028),
 (95, 36,0,1,29808676),
 (96, 36,0,1,17885205),
 (97, 36,0,1,14904338),
 (98, 37,1,0,22896773.1),
 (99, 37,0,1,7632257.7),
 (100, 37,0,1,4579354.62),
 (101, 37,0,1,3816128.85),
 (102, 38,1,0,208694337),
 (103, 38,0,1,69564779),
 (104, 38,0,1,41738867),
 (105, 38,0,1,34782389),
 (106, 39,1,0,103630161),
 (107, 39,0,1,34543387),
 (108, 39,0,1,20726032),
 (109, 39,0,1,17271693),
 (106, 40,1,0,28227897),
 (110, 40,0,1,9409299),
 (111, 40,0,1,5645579),
 (112, 40,0,1,4704649),
 (113, 41,1,0,88331971),
 (114, 41,0,1,29443990),
 (115, 41,0,1,17666394),
 (54, 41,0,1,14721995),
 (116, 42,1,0,111768008),
 (117, 42,0,1,37256002),
 (118, 42,0,1,22353601),
 (119, 42,0,1,18628001),
 (120, 43,1,0,13947183),
 (121, 43,0,1,4649061),
 (122, 43,0,1,2789436),
 (123, 43,0,1,2324530),
 (124, 44,1,0,409684578),
 (125, 44,0,1,136561526),
 (126, 44,0,1,81936915),
 (127, 44,0,1,68280763),
 (128, 45,1,0,92649339),
 (75, 45,0,1,30883113),
 (129, 45,0,1,18529867),
 (130, 45,0,1,15441556),
 (131, 46,1,0,211490390),
 (108, 46,0,1,70496796),
 (83, 46,0,1,42298078),
 (132, 46,0,1,35248398),
 (124, 47,1,0,548671815),
 (125, 47,0,1,182890605),
 (133, 47,0,1,109734363),
 (127, 47,0,1,91445302),
 (6, 48,1,0,9838791),
 (134, 48,0,1,3279597),
 (81, 48,0,1,1967758),
 (135, 48,0,1,1639798),
 (136, 49,1,0,86174736),
 (137, 49,0,1,28724912),
 (138, 49,0,1,17234947),
 (139, 49,0,1,14362456),
 (120, 50,1,0,18983591),
 (140, 50,0,1,6327863),
 (141, 50,0,1,3796718),
 (64, 50,0,1,3163931),
 (27, 51,1,0,2325505),
 (51, 51,0,1,775168),
 (142, 51,0,1,465101),
 (143, 51,0,1,387584),
 (144, 52,1,0,178707),
 (145, 52,0,1,59569),
 (146, 52,0,1,35741),
 (147, 52,0,1,29784),
 (148, 53,1,0,33817093),
 (149, 53,0,1,11272364),
 (150, 53,0,1,6763418),
 (151, 53,0,1,5636182),
 (57, 54,1,0,95712891),
 (20, 54,0,1,31904297),
 (152, 54,0,1,19142578),
 (153, 54,0,1,15952148),
 (57, 55,1,0,76946631),
 (20, 55,0,1,25648877),
 (154, 55,0,1,15389326),
 (155, 55,0,1,12824438),
 (57, 56,1,0,100701541),
 (20, 56,0,1,33567180),
 (156, 56,0,1,20140308),
 (157, 56,0,1,16783590),
 (57, 57,1,0,166163259),
 (20, 57,0,1,55387753),
 (158, 57,0,1,33232651),
 (159, 57,0,1,27693876),
 (160, 58,1,0,556339151),
 (161, 58,0,1,185446383),
 (162, 58,0,1,111267830),
 (110, 58,0,1,92723191),
 (163, 59,1,0,81570759),
 (164, 59,0,1,27190253),
 (165, 59,0,1,16314151),
 (166, 59,0,1,13595126),
 (167, 60,1,0,331833701),
 (168, 60,0,1,110611233),
 (169, 60,0,1,66366740),
 (170, 60,0,1,55305616),
 (82, 61,1,0,78566839),
 (54, 61,0,1,26188946),
 (171, 61,0,1,15713367),
 (172, 61,0,1,13094473),
 (82, 62,1,0,63422794),
 (54, 62,0,1,21140931),
 (173, 62,0,1,12684558),
 (127, 62,0,1,10570465),
 (174, 63,1,0,565290),
 (175, 63,0,1,188430),
 (176, 63,0,1,113058),
 (177, 63,0,1,94215),
 (178, 64,1,0,182155209),
 (179, 64,0,1,60718403),
 (180, 64,0,1,36431041),
 (125, 64,0,1,30359201),
 (178, 65,1,0,228369012),
 (179, 65,0,1,76123004),
 (181, 65,0,1,45673802),
 (182, 65,0,1,38061502),
 (178, 66,1,0,410394327),
 (179, 66,0,1,136798109),
 (183, 66,0,1,82078865),
 (184, 66,0,1,68399054),
 (185, 67,1,0,30779623),
 (186, 67,0,1,10259874),
 (17, 67,0,1,6155924),
 (187, 67,0,1,5129937),
 (116, 68,1,0,198372183),
 (188, 68,0,1,66124061),
 (189, 68,0,1,39674436),
 (190, 68,0,1,33062030),
 (31, 69,1,0,90489657),
 (191, 69,0,1,30163219),
 (192, 69,0,1,18097931),
 (193, 69,0,1,15081609),
 (194, 70,1,0,182365459),
 (195, 70,0,1,60788486),
 (196, 70,0,1,36473091),
 (197, 70,0,1,30394243),
 (198, 71,1,0,36648809),
 (199, 71,0,1,12216269),
 (200, 71,0,1,7329761),
 (201, 71,0,1,6108134),
 (106, 72,1,0,11195536),
 (20, 72,0,1,3731845),
 (202, 72,0,1,2239107),
 (203, 72,0,1,1865922),
 (204, 73,1,0,37165987),
 (205, 73,0,1,12388662),
 (161, 73,0,1,7433197),
 (206, 73,0,1,6194331),
 (207, 74,1,0,37165987),
 (208, 74,0,1,12388662),
 (209, 74,0,1,7433197),
 (210, 74,0,1,6194331),
 (211, 75,1,0,106869105),
 (212, 75,0,1,35623035),
 (213, 75,0,1,21373821),
 (214, 75,0,1,17811517),
 (57, 76,1,0,111355669),
 (215, 76,0,1,37118556),
 (216, 76,0,1,22271133),
 (217, 76,0,1,18559278),
 (218, 77,1,0,35172832),
 (219, 77,0,1,11724277),
 (220, 77,0,1,7034566),
 (221, 77,0,1,5862138),
 (31, 78,1,0,7545950),
 (32, 78,0,1,2515316),
 (33, 78,0,1,1509190),
 (34, 78,0,1,1257658),
 (6, 79,1,0,24414930),
 (7, 79,0,1,8138310),
 (222, 79,0,1,4882986),
 (223, 79,0,1,4069155),
 (224, 80,1,0,50215642),
 (225, 80,0,1,16738547),
 (226, 80,0,1,10043128),
 (227, 80,0,1,8369273),
 (228, 81,1,0,93462195),
 (229, 81,0,1,31154065),
 (230, 81,0,1,18692439),
 (231, 81,0,1,15577032),
 (232, 82,1,0,171043674),
 (233, 82,0,1,57014558),
 (234, 82,0,1,34208734),
 (235, 82,0,1,28507279),
 (236, 83,1,0,48282460),
 (237, 83,0,1,16094153),
 (205, 83,0,1,9656492),
 (238, 83,0,1,8047076),
 (239, 84,1,0,117592668),
 (240, 84,0,1,39197556),
 (241, 84,0,1,23518533),
 (242, 84,0,1,19598778),
 (243, 85,1,0,1273622),
 (182, 85,0,1,424540),
 (244, 85,0,1,254724),
 (245, 85,0,1,212270),
 (160, 86,1,0,440637625),
 (54, 86,0,1,146879208),
 (246, 86,0,1,88127525),
 (247, 86,0,1,73439604),
 (248, 87,1,0,9264102),
 (249, 87,0,1,3088034),
 (250, 87,0,1,1852820),
 (76, 87,0,1,1544017),
 (160, 88,1,0,17511360),
 (251, 88,0,1,5837120),
 (252, 88,0,1,3502272),
 (253, 88,0,1,2918560),
 (82, 89,1,0,8525021),
 (83, 89,0,1,2841673),
 (254, 89,0,1,1705004),
 (255, 89,0,1,1420836),
 (256, 90,1,0,30693027),
 (257, 90,0,1,10231009),
 (258, 90,0,1,6138605),
 (259, 90,0,1,5115504),
 (1, 91,1,0,116247960),
 (260, 91,0,1,38749320),
 (261, 91,0,1,23249592),
 (99, 91,0,1,19374660),
 (262, 92,1,0,201409485),
 (263, 92,0,1,67136495),
 (264, 92,0,1,40281897),
 (265, 92,0,1,33568247),
 (262, 93,1,0,201409485),
 (263, 93,0,1,67136495),
 (264, 93,0,1,40281897),
 (266, 93,0,1,33568247),
 (267, 94,1,0,157164962),
 (263, 94,0,1,52388320),
 (264, 94,0,1,31432992),
 (266, 94,0,1,26194160),
 (268, 95,1,0,178092755),
 (263, 95,0,1,59364251),
 (264, 95,0,1,35618551),
 (266, 95,0,1,29682125),
 (269, 96,1,0,185199115),
 (263, 96,0,1,61733038),
 (264, 96,0,1,37039823),
 (266, 96,0,1,30866519),
 (269, 97,1,0,185528064),
 (263, 97,0,1,61842688),
 (264, 97,0,1,37105612),
 (266, 97,0,1,30921344),
 (269, 98,1,0,191016750),
 (263, 98,0,1,63672250),
 (264, 98,0,1,38203350),
 (266, 98,0,1,31836125),
 (269, 99,1,0,258571129),
 (263, 99,0,1,86190376),
 (264, 99,0,1,51714225),
 (266, 99,0,1,43095188),
 (57, 100,1,0,73566877),
 (168, 100,0,1,24522292),
 (270, 100,0,1,14713375),
 (271, 100,0,1,12261146),
 (113, 101,1,0,48278628),
 (272, 101,0,1,16092876),
 (273, 101,0,1,9655725),
 (181, 101,0,1,8046438),
 (274, 102,1,0,102214175),
 (275, 102,0,1,34071391),
 (276, 102,0,1,20442835),
 (277, 102,0,1,17035695),
 (57, 103,1,0,184507774),
 (278, 103,0,1,61502591),
 (279, 103,0,1,36901554),
 (280, 103,0,1,30751295),
 (281, 104,1,0,143951689),
 (275, 104,0,1,47983896),
 (282, 104,0,1,28790337),
 (283, 104,0,1,23991948)





/******************************************************************************/

MERGE Movie.Roles R
USING @RolesStaging RS ON RS.RoleId = R.RoleId
WHEN MATCHED THEN
   UPDATE
   SET 
   R.PersonId = RS.PersonId,
   R.MovieId = RS.MovieId,
   R.IsDirector = RS.IsDirector,
   R.IsActor = RS.IsActor,
   R.AmountPaid = RS.AmountPaid
WHEN NOT MATCHED THEN
   INSERT(PersonId, MovieId, IsDirector, IsActor, AmountPaid)
   VALUES(RS.PersonId, RS.MovieId, RS.IsDirector, RS.IsActor, RS.AmountPaid);