DECLARE @MoviesStaging TABLE
(
   MovieId INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
   StudioId INT NOT NULL,
   MovieName NVARCHAR(256) NOT NULL,
   [ReleaseDate] SMALLINT NOT NULL,
   IMDBRating DECIMAL(3,1) NOT NULL,
   RottenTomatoesAudienceRating INT NOT NULL,
   DomesticRevenue BIGINT NOT NULL,
   InternationalRevenue BIGINT NOT NULL,
   Cost INT NOT NULL,
   GenreId INT NOT NULL,
   RottenTomatoesCriticRating INT NOT NULL,
   UNIQUE(MovieName, [ReleaseDate])
);

/***************************** Modify values here *****************************/

INSERT @MoviesStaging(StudioId, MovieName, [ReleaseDate], IMDBRating, RottenTomatoesAudienceRating, DomesticRevenue, InternationalRevenue, Cost, GenreId, RottenTomatoesCriticRating)
VALUES
  (1, N'Lord of the Rings: Fellowship of the Ring',2001, 8.8, 95, 316115420, 898204420,93000000 ,6, 91),
 (2, N'Lord of the Rings: The Two Towers',2002, 8.8, 95, 342952511, 947944270,94000000 ,6, 95),
 (2, N'Lord of the Rings: Return of the King',2003, 9, 86, 379427292, 1147633833,94000000 ,6, 93),
 (2, N'Batman Begins',2005, 8.2, 94, 205343774, 358858124,150000000 ,1, 84),
 (1, N'The Dark Knight',2008, 9, 94, 534987076, 1006234167,185000000 ,1, 94),
 (1, N'The Dark Knight Rises',2012, 8.4, 90, 448139099, 1082228107,230000000,1, 87),
 (3, N'Star Wars: The Phantom Menace',1999, 6.5, 59, 474544677, 1027044677,115000000,12, 51),
 (3, N'Star Wars: Attack of the Clones',2002, 6.6, 56, 310676740, 656695615,115000000,12, 65),
 (3, N'Star Wars: Revenge of the Sith',2005, 7.6, 66, 380270577, 868390560,113000000,12, 79),
 (3, N'Star Wars: A New Hope',1977, 8.6, 96, 460998507, 775398007,11000000,12, 93),
 (3, N'Star Wars: The Empire Strikes Back',1980, 8.7, 97, 292753960, 538375067,18000000,12, 94),
 (3, N'Star Wars: The Return of the Jedi',1983, 8.3, 94, 309306177, 475106177,32500000,12, 83),
 (4, N'Star Wars: The Force Awakens',2015, 7.8, 95, 936662225, 2071310218,245000000,12, 93),
 (4, N'Star Wars: The Last Jedi',2017, 6.9, 42, 620181382, 1334407706,317000000,12, 91),
 (4, N'Star Wars: The Rise of Skywalker',2019, 6.5, 86, 515202542, 1077022372,275000000,12, 52),
 (5, N'Psycho',1960, 8.5, 95, 32000000, 32052925,806947,8, 96),
 (6, N'The Wizard of Oz',1939, 8.1, 89, 24668669, 25637669,2777000,6, 98),
 (1, N'Casablanca',1942, 8.5, 95, 4219709, 4626532,950000,5, 99),
 (7, N'Citizen Kane',1941, 8.3, 90, 1627530, 1645944,839727,5, 99),
 (5, N'The Godfather',1972, 9.2, 98, 136381073, 250341816,6000000,5, 97),
 (8, N'The Sound of Music',1965, 8.1, 91, 159287539, 159437744,8200000,9, 84),
 (7, N'Its a Wonderful Life',1946, 8.6, 95, 1483643, 8574081,3180000,4, 94),
 (1, N'Inception',2010, 8.8, 91, 292587330, 836504484,160000000,12, 87),
 (9, N'Schindlers List',1993, 9, 97, 96898818, 322161245,22000000,7, 98),
 (9, N'Jurassic Park',1993, 8.2, 91, 404214720, 1109802321,63000000,2, 91),
 (9, N'Jurassic Park: The Lost World',1997, 6.5, 51, 229086679, 618638999,73000000,2, 54),
 (9, N'Jurassic Park III',2001, 5.9, 36, 181171875, 368780809,93000000,2, 49),
 (10, N'The ShawShank Redemption',1994, 9.2, 98, 28767189, 28884504,25000000,5, 91),
 (6, N'The Good, The Bad, and the Ugly',1966, 8.8, 97, 25100000, 25253887,1200000,16, 97),
 (5, N'Forrest Gump',1994, 8.8, 95, 330455270, 678226465,55000000,4, 71),
 (1, N'The Matrix',1999, 8.7, 85, 172076928, 467222728,63000000,12, 88),
 (1, N'Goodfellas',1990, 8.7, 97, 46909721, 47036784,25000000,5, 96),
 (10, N'Seven Samurai',1954, 8.6, 97, 318649, 346258,875000,1, 100),
 (5, N'Saving Private Ryan',1998, 8.6, 95, 217049603, 482349603,70000000,15, 94),
 (5, N'Interstellar',2014, 8.6, 86, 188020017, 773430538,165000000,12, 73),
 (9, N'Back to the Future',1985, 8.5, 94, 212836762, 383336762,19000000,4, 97),
 (11, N'The Pianist',2002, 8.5, 96, 32572577, 120072577,35000000,7, 95),
 (4, N'The Lion King',1994, 8.5, 93, 422783777, 968511805,45000000,2, 93),
 (9, N'Gladiator',2000, 8.5, 87, 187705427, 503162313,103000000,7, 80),
 (8, N'Alien',1979, 8.4, 94, 81900459, 106285522,11000000 ,12, 98),
 (12, N'Django Unchained',2012, 8.4, 92, 162805434, 426074373,100000000 ,16, 87),
 (13, N'WALL-E',2008, 8.4, 90, 223808164, 521311890,180000000 ,2, 95),
 (1, N'The Shining',1980, 8.4, 93, 45634352, 47346869,19000000 ,8, 82),
 (4, N'Avengers: Infinity War',2018, 8.4, 92, 678815482, 2052415039,321000000 ,1, 85),
 (1, N'Toy Story',1995, 8.3, 92, 223225679, 394436586,30000000 ,4, 100),
 (1, N'Joker',2019, 8.3, 88, 335477657, 1074458282,55000000 ,5, 69),
 (4, N'Avengers: Endgame',2019, 8.3, 90, 858373000, 2799439100,356000000 ,1, 94),
 (15, N'Memento',2000, 8.4, 94, 25544867, 40047078,9000000 ,10, 93),
 (10, N'Spiderman: Into the Spider-Verse',2018, 8.3, 93, 190241310, 384256930,90000000 ,1, 97),
 (1, N'2001: A Space Odyssey',1968, 8.3, 89, 60481243, 66076033,12000000 ,12, 92),
 (5, N'Vertigo',1958, 8.2, 93, 7705225, 7798146,2479000 ,10, 92),
 (9, N'To Kill A Mockingbird',1962, 8.2, 93, 592237, 599146,2000000 ,5, 93),
 (8, N'Die Hard',1988, 8.2, 94, 83844093, 141603197,28000000 ,1, 94),
 (5, N'Raiders of the Lost Ark',1981, 8.4, 96, 248159971, 389925971,18000000 ,2, 96),
 (5, N'Indiana Jones and the Temple of Doom',1984, 7.5, 92, 179870271, 333107271,28000000 ,2, 76),
 (5, N'Indiana Jones and the Last Crusade',1989, 8.2, 94, 197171806, 474171806,48000000 ,2, 80),
 (5, N'Indiana Jones and the Kingdom of the Cyrstal Skull',2008, 6.2, 53, 317101119, 790653942,185000000 ,2, 77),
 (8, N'Avatar',2009, 7.9, 82, 785221649, 2923706026,237000000 ,12, 82),
 (9, N'1917',2019, 8.2, 88, 159227644, 384577421,95000000 ,15, 89),
 (5, N'Top Gun: Maverick',2022, 8.2, 99, 718732821, 1493491858,170000000 ,1, 96),
 (5, N'The Wolf of Wall Street',2013, 8.2, 83, 116900694, 406878233,100000000 ,4, 80),
 (5, N'Shutter Island',2010, 8.2, 77, 128012934, 294805697,80000000 ,10, 68),
 (10, N'Monty Python and the Holy Grail',1975, 8.1, 95, 1827696, 1940906,253622,4, 98),
 (16, N'Spider-Man: Homecoming',2017, 7.4, 87, 334201140, 880166924,175000000 ,1, 92),
 (16, N'Spider-Man: Far from Home',2019, 7.4, 95, 390532085, 1131927996,160000000 ,1, 90),
 (16, N'Spider-Man: No Way Home',2021, 8.2, 98, 814115070, 1921847111,200000000,1, 93),
 (1, N'V for Vendetta',2005, 8.1, 90, 70511035, 134686457,54000000 ,1, 73),
 (4, N'Finding Nemo',2003, 8.1, 86, 380843261, 941637960,94000000 ,4, 99),
 (6, N'Gone With the Wind',1939, 8.1, 92, 200882193, 402382193,3977000 ,11, 90),
 (4, N'Inside Out',2015, 8.1, 89, 356921711, 858848019,175000000 ,4, 98),
 (14, N'Howls Moving Castle',2004, 8.1, 93, 6789268, 237536126,24000000 ,6, 87),
 (1, N'Blade Runner',1982, 8.1, 91, 32914489, 41722424,28000000 ,12, 89),
 (17, N'Hacksaw Ridge',2016, 8.1, 91, 67209615, 180563636,40000000 ,15, 84),
 (1, N'Mad Max: Fury Road',2015, 8.1, 86, 67209615, 180563636,40000000 ,1, 97),
 (5, N'How to Train Your Dragon',2010, 8.1, 91, 217581231, 494879471,165000000 ,6, 99),
 (18, N'Jaws',1975, 8.1, 90, 265859065, 476512065,7000000 ,10, 97),
 (6, N'Rocky',1976, 8, 69, 117235147, 117250402,960000 ,5, 92),
 (14, N'The Prestige',2006, 8.5, 92, 53089891, 109676311,40000000 ,5, 76),
 (16, N'Baby Driver',2017, 7.6, 86, 107825862, 226945087,34000000 ,1, 92),
 (17, N'La La Land',2016, 8, 81, 151101803, 471979503,30000000 ,9, 91),
 (1, N'The Batman',2022, 7.8, 87, 369345583, 770945583,200000000 ,1, 85),
 (16, N'The Social Network',2010, 7.8, 87, 96962694, 224920375,40000000 ,5, 96),
 (16, N'Casino Royale',2006, 8, 90, 167445960, 616505162,150000000 ,1, 94),
 (15, N'Donnie Darko',2001, 8, 80, 1478493, 7012321,6000000 ,5, 87),
 (5, N'Titanic',1997, 7.9, 69, 674292608, 2263291560,200000000 ,7, 88),
 (8, N'The Princess Bride',1987, 8, 94, 30857814, 30902869,16000000 ,2, 98),
 (6, N'The Terminator',1984, 8.1, 89, 38371200, 78371200,6400000 ,12, 100),
 (10, N'Taxi Driver',1976, 8.2, 93, 28262574, 28570902,1300000 ,5, 96),
 (8, N'Butch Cassidy and the Sundance Kid',1969, 8, 92, 102308889, 102311293,6000000 ,16, 89),
 (9, N'King Kong',2005, 7.2, 50, 218080025, 556906378,207000000 ,2, 84),
 (1, N'Harry Potter and the Philosophers Stone',2001, 7.6, 82, 318886962, 1023842938,125000000 ,6, 81),
 (1, N'Harry Potter and the Chamber of Secrets',2002, 7.4, 80, 262641637, 925668380,100000000 ,6, 82),
 (1, N'Harry Potter and the Prisoner of Azkaban',2004, 7.9, 86, 250105651, 797660766,130000000 ,6, 90),
 (1, N'Harry Potter and the Goblet of Fire',2005, 7.7, 74, 290469928, 896815106,150000000 ,6, 88),
 (1, N'Harry Potter and the Order of the Phoeniz',2007, 7.5, 81, 292382727, 942278045,150000000 ,6, 78),
 (1, N'Harry Potter and the Half-Blood Prince',2009, 7.6, 78, 302334374, 934519387,250000000 ,6, 84),
 (1, N'Harry Potter and the Deathly Hallows Part 1. ',2010, 7.7, 85, 296374621, 977070383,150000000 ,6, 77),
 (1, N'Harry Potter and the Deathly Hallows Part 2.',2011, 8.1, 89, 381447587, 1342359942,125000000 ,6, 96),
 (8, N'Minority Report',2002, 7.6, 80, 132072926, 358372926,102000000 ,12, 90),
 (19, N'Pulp Fiction',1994, 8.9, 96, 107928762, 213928762,8000000 ,5, 92),
 (1, N'Charlie and the Chocolate Factory',2005, 6.7, 51, 206459076, 474968763,150000000 ,6, 83),
 (9, N'E.T. the Extra-Terrestrial',1982, 7.9, 72, 437141279, 792910554,10500000,12, 99),
 (4, N'Pirates of the Caribean: The Curse of the Black Pearl',2003, 8.1, 86, 305413918, 654264015,140000000 ,2, 80)



/******************************************************************************/

MERGE Movie.Movies M
USING @MoviesStaging MS ON MS.MovieId = M.MovieId
WHEN MATCHED THEN
   UPDATE
   SET 
   M.StudioId = MS.StudioId,
   M.MovieName = MS.MovieName,
   M.ReleaseDate = MS.ReleaseDate,
   M.IMDBRating = MS.IMDBRating,
   M.RottenTomatoesAudienceRating = MS.RottenTomatoesAudienceRating,
   M.DomesticRevenue = MS.DomesticRevenue,
   M.InternationalRevenue = MS.InternationalRevenue,
   M.Cost = MS.Cost,
   M.GenreId = MS.GenreId,
   M.RottenTomatoesCriticRating = MS.RottenTomatoesCriticRating
WHEN NOT MATCHED THEN
   INSERT(StudioId, MovieName, ReleaseDate, IMDBRating, RottenTomatoesAudienceRating , DomesticRevenue , InternationalRevenue , Cost, GenreId, RottenTomatoesCriticRating)
   VALUES(MS.StudioId, MS.MovieName, MS.ReleaseDate, MS.IMDBRating, MS.RottenTomatoesAudienceRating , MS.DomesticRevenue , MS.InternationalRevenue , MS.Cost, MS.GenreId, MS.RottenTomatoesCriticRating);